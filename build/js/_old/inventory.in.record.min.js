$(function(){$(window).on("blur focus",function(g){var f=$(this).data("prevType");if(f!=g.type){switch(g.type){case"focus":d.ajax.reload()}}$(this).data("prevType",g.type)});a("Processing","Please wait..","info",999999);function e(j,g,h){var f=new XMLHttpRequest();f.open("GET",j,true);f.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var k=JSON.parse(this.responseText);$(g).detach();$(h).append('<option value="">ALL</option>');for(i=0;i<k.length;i++){$(h).append("<option value='"+k[i].value+"'>"+k[i].value+"</option>")}$(h).prop("disabled",false)}};f.send()}e(base_url+"inventory/ajax_get_risno?str=I-","#col0_filter option","#col0_filter");e(base_url+"inventory/ajax_get_location?str=I-","#col1_filter option, #col2_filter option","#col1_filter, #col2_filter");e(base_url+"inventory/ajax_get_fund?str=I-","#col3_filter option","#col3_filter");e(base_url+"inventory/ajax_get_program?str=I-","#col4_filter option","#col4_filter");$("select#col0_filter").select2({placeholder:"Select RIS NO",allowClear:true});var b=null;var d=$("#dt_in_record").DataTable({ajax:{url:base_url+"inventory/ajax_record_in",dataSrc:""},columns:[{data:"tr_rs_no"},{data:"tr_supplier"},{data:"DESTINATION"},{data:"tr_funding"},{data:"tr_program"}],fnCreatedRow:function(g,h,f){$(g).attr("data-tr_location",h.SOURCE);$(g).attr("data-tr_funding",h.tr_funding);$(g).attr("data-tr_program",h.tr_program);$(g).attr("data-tr_destination",h.DESTINATION);$(g).attr("data-tr_receivedby",h.RECEIVED_BY);$(g).attr("data-tr_allocateby",h.ALLOCATE_BY);$(g).attr("data-tr_date",h.tr_date);$(g).attr("data-tr_rs_no",h.tr_rs_no);if(h.tr_supplier){$(g).attr("data-tr_supplier",h.tr_supplier)}else{$(g).attr("data-tr_supplier","")}$(g).attr("data-addedby",h.a_name)},dom:'<"wrapper"Bfit>',info:false,order:[[0,"desc"]],scrollY:400,scrollX:true,scrollCollapse:true,paging:false,buttons:[{extend:"excelHtml5",customize:function(g){var f=g.xl.worksheets["sheet1.xml"];$('row c[r^="C"]',f).attr("s","2")}},{extend:"print",exportOptions:{columns:":visible"},},],order:[[0,"desc"]],deferRender:true,scrollY:400,scrollCollapse:true,scroller:true,scrollX:true,initComplete:function(){$(".alert-info .glyphicon-remove").trigger("click")}});$("#dt_in_record tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{d.$("tr.selected").removeClass("selected");$(this).addClass("selected")}var f=$(this).attr("data-tr_rs_no");if($("body .ui-pnotify > .alert-info").length==0){if(typeof f!==typeof undefined&&f!==false){$("#tbl_print_preview tbody").empty();$("#mdl-print-draft .modal-body p:eq(1)").text($(this).data("tr_funding"));$("#mdl-print-draft .modal-body p:eq(2)").text($(this).data("tr_program"));$("#mdl-print-draft .modal-body p:eq(3)").text($(this).data("tr_destination"));$("#mdl-print-draft .modal-body p:eq(4)").text($(this).data("tr_receivedby"));$("#mdl-print-draft .modal-body p:eq(5)").text($(this).data("tr_allocateby"));$("#mdl-print-draft .modal-body p:eq(6)").text($(this).data("tr_date"));$("#mdl-print-draft .modal-body p:eq(7)").text($(this).data("tr_rs_no"));$("#mdl-print-draft .modal-body p:eq(0)").text($(this).data("tr_supplier"));$("#mdl-print-draft .modal-body p:eq(8)").text($(this).data("addedby"));var g={tr_rs_no:$(this).data("tr_rs_no"),tr_location:$(this).data("tr_location")};$.ajax({dataType:"json",type:"GET",url:base_url+"inventory/ajax_search_record",data:g,beforeSend:function(){a("Processing","Please wait..","info",999999)},success:function(h){$(".alert-info .glyphicon-remove").trigger("click");b=h;$.each(h,function(j,k){$("#tbl_print_preview tbody").append("<tr><td>"+k.m_name+" ["+k.tr_lot_no+"]</td><td>"+k.tr_rs_no+"</td><td>"+k.tr_pcsper_set+" ["+k.tr_unit+']</td><td class="text-right">'+k.tr_qty+"</td></tr>")});$("#mdl-print-draft").modal("show")},error:function(h,k,j){a("Error!","Connection problems occurred... Unable to connect to the Internet! The Internet connection has been lost.","error",1500)}})}}return false});$("body").delegate("#btn_record_print","click",function(){$("#tbl-print tr.print").empty();$.each(b,function(f,g){$("#tbl-print tr.title").after("<tr class='print'><td style='color:"+g.remarks+"'>&nbsp; "+g.tr_expiration_date+"</td><td colspan='2'> &nbsp;"+g.m_name+" ["+g.tr_lot_no+"]</td><td>&nbsp; "+g.tr_pcsper_set+" ["+g.tr_unit+"]</td><td class='text-right'>"+g.tr_qty+"&nbsp;</td><td colspan='2'></td></tr>")});$("#tbl-print span.source").text($("#mdl-print-draft .modal-body p:eq(0)").text());$("#tbl-print span.destination").text($("#mdl-print-draft .modal-body p:eq(3)").text());$("#tbl-print span.date").text($("#mdl-print-draft .modal-body p:eq(6)").text());if($("#mdl-print-draft .modal-body p:eq(8)").text()=="CIELO SALONGA"){$("#tbl-print span.tr_allocateby").text($("#mdl-print-draft .modal-body p:eq(8)").text())}$("#tbl-print .p_risno").text($("#mdl-print-draft .modal-body p:eq(7)").text());$("#mdl-recordprint").modal("show")});$(".column_filter").on("keyup click change",function(){c($(this).parents("div").attr("data-column"))});function c(f){$("#dt_in_record").DataTable().column(f).search($("#col"+f+"_filter").val()).draw()}$("body").delegate("#btn_cancel","click",function(){$("#frm_sdispense").data("formValidation").resetForm();$("#frm_sdispense")[0].reset();$("#print-report, ._print").addClass("hidden")});function a(h,f,j,g){new PNotify({title:h,text:f,styling:"bootstrap3",type:j,delay:g})}$("body").delegate("a._refresh","click",function(){d.ajax.reload();$("#col0_filter, .filter select").val(null).trigger("change")})});function printContent(a){var b=document.getElementById(a);newWin=window.open("");newWin.document.write("<html><head><style>table{width:100%}b, strong {font-weight:700}table {border-collapse:collapse;}table td, table th{ border: 1px solid black; text-align:left;}tr.group{background-color: #d8d8d8;margin-top:10px;padding-top:10px} .img-logo {position:absolute;left:calc(50% - 200px);top:11px}.th-head{position:relative;padding:10px 0}p.p-version{position:absolute;top:0;right:3px;font-size:9px}.version{position:relative}.p_risno{position:absolute;right:6px;top:3px}.text-right{text-align:right}</style>");newWin.document.write('</head><body onload="window.print()">');newWin.document.write(b.outerHTML);newWin.document.write("</body>");newWin.document.write("</html>");newWin.print();newWin.close()};