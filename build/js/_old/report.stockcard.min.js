$(function(){var f=$("#medicine"),e=$("#frm_stockcard");f.select2({placeholder:"Select Medicine",});function a(g,k,l,j){var h="",m=new XMLHttpRequest();m.open("GET",g,true);m.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var n=JSON.parse(this.responseText);$(k).detach();h+='<option value="">- - -</option>';if(j==1){h+="<option value='N/A'>N/A</option>"}for(i=0;i<n.length;i++){h+="<option value='"+n[i].value+"'>"+n[i].value+"</option>"}$(l).html(h);$(l).prop("disabled",false)}};m.send()}a(base_url+"admin/ajax_get_tr_funding","#str_funding option","#str_funding",0);a(base_url+"admin/ajax_get_program","#str_program option","#str_program",1);var b="",d=new XMLHttpRequest();d.open("GET",base_url+"report/ajax_get_medicine_stockcard",true);d.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var g=JSON.parse(this.responseText);$("#medicine option").detach();b+='<option value="">- - -</option>';for(i=0;i<g.length;i++){b+="<option value='"+g[i].m_id+"'>"+g[i].m_name+"</option>"}f.html(b);f.prop("disabled",false)}};d.send();e.formValidation({framework:"bootstrap",button:{selector:"#btn_search",disabled:"disabled"},icon:null,}).on("success.form.fv",function(l){l.preventDefault();var g=$(l.target),k=g.data("formValidation");var h=base_url+"report/ajax_get_stockcard",j=e.serializeObject();c(h,j);g.data("formValidation").disableSubmitButtons(false);return false});function c(g,k){notify("Processing","Please wait..","info",999999);$("#print-report .heading p:eq(0) span").text($("#medicine option:selected").text());$("#print-report .heading p:eq(1) span").text($("#str_funding").val());$("#print-report .heading p:eq(2) span").text($("#str_program").val());$("#print-report .heading p:eq(3) span:eq(0)").text($("#tr_location").val());$("#print-report, ._print").removeClass("hidden");var j=$("#tr_format").val();$("#dt_stockcard").dataTable().fnClearTable();$("#dt_stockcard").dataTable().fnDestroy();var h=$("#dt_stockcard").DataTable({ajax:{type:"GET",url:g,data:k,dataSrc:""},columns:[{data:"tr_date"},{data:"TRAN"},{data:"tr_rs_no"},{data:"RELEASED_BY"},{data:"RECIEVED_BY"},{data:function(l){return'<div class="text-right">'+l.IN+"</div>"}},{data:function(l){return'<div class="text-right">'+l.OUT+"</div>"}},{data:function(l){return'<div class="text-right">'+l.BALANCE+"</div>"}}],dom:'<"wrapper"fit>',bFilter:false,ordering:false,info:false,scrollX:true,paging:false,scrollY:500,scrollCollapse:true,buttons:["copy","csv","excel","pdf","print"],columnDefs:[],fnInitComplete:function(m,l){$(".alert-info .glyphicon-remove").trigger("click")}})}$("body").delegate("#btn_scancel","click",function(){$("#medicine").val(null).trigger("change");e.data("formValidation").resetForm();e[0].reset();$("#print-report, ._print").addClass("hidden")});$.fn.serializeObject=function(){var h={};var g=this.serializeArray();$.each(g,function(){if(h[this.name]){if(!h[this.name].push){h[this.name]=[h[this.name]]}h[this.name].push(this.value||"")}else{h[this.name]=this.value||""}});return h}});